
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>RNA-seq quantification comparison: K-mer vs. alignment approaches</title>
    <meta name="description" content="RNA-seq DEG approaches">
    <meta name="author" content="Jinliang Yang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles change to Yihui style -->
    <!-- link rel="stylesheet" href="/media/css/style.css"  -->
    <link rel="stylesheet" href="/media/css/highlight.css">
    <link href="/assets/themes//bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes//bootstrap/css/style.css" rel="stylesheet">
    <link href="/assets/themes//css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Jinliang Yang</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>RNA-seq quantification comparison: K-mer vs. alignment approaches </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>03 June 2015</span>
    </div>
    <div class="content">
      <h1>Background</h1>

<p>RNA-seq short reads quantification, or simply, counting how many reads mapped to a set of genes, is the key step for differential expression analysis. Traditionally, reads were mapped to the reference genome and then were counted based on the mapping information. It normally takes days or weeks with multiple CPUs, just for the alignment. Recently, K-mer strategy was proposed as an alignment-free alternative, including <a href="http://www.nature.com/nbt/journal/v32/n5/full/nbt.2862.html">Sailfish</a> and <a href="http://arxiv.org/pdf/1505.02710v2.pdf">kallisto</a>. Strange names, are they?
Anyway, with no doubt, these K-mer approaches run much faster comparing to alignment-based approaches. See below figure stole from <a href="http://www.cs.cmu.edu/~ckingsf/class/02-714/Lec05-sailfish.pdf">Rob Patro's presentation</a>.
<img src="http://i.imgur.com/YVhf5tz.png" alt="Imgur" /></p>

<p>What is K-mer? Simply speaking, K-mer is a string of length K. For instance, "ATCG" is 4-mer sequence. For a given sequence of length N, it will extract <code>N-k+1</code> k-mers.
<img src="http://i.imgur.com/GQyglzb.png" alt="Imgur" /></p>

<p>The paradigm for a K-mer approach would be:<br/>
1. Build k-mer index of your target transcripts (e.g. your gene annotation).<br/>
2. Count k-mer in your RNA-seq reads.<br/>
3. Quantification.</p>

<h1>Setup the experiment</h1>

<p>To convince myself these approaches are as accurate as traditional ones, I setup an experiment to compare the results generated by both traditional alignment-based approach and K-mer approach. The analyzing codes were deposited in the github <a href="https://github.com/yangjl/Demo">repo</a>.</p>

<p>First, I downloaded some RNA-seq data from NCBI by using <code>wget</code> and obtained the reference genome from <a href="http://plants.ensembl.org/Oryza_indica/Info/Index">EnsemblePlants</a>. I used GSNAP for short reads alignment. And some bioconductor packages, including <code>GenomicFeatures</code> and <code>GenomicAlignments</code>, for read count quantification. The detailed procedure can be found <a href="http://rpubs.com/yangjl0930/61344">here for alignment</a> and <a href="http://rpubs.com/yangjl0930/60157">here for quantification</a>. Or a shorter version <a href="http://rpubs.com/yangjl0930/63347">here</a>.</p>

<pre><code>### get RNA-seq reads
wget get ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR117/SRR1174772/SRR1174772.sra
### get reference genome
wget ftp://ftp.ensemblgenomes.org/pub/plants/release-25/fasta/oryza_indica/dna/Oryza_indica.ASM465v1.25.dna.chromosome.*.fa.gz
### alignment with gmap
gmap_build -D largedata/OS_indica/ -d ASM465v1.25_gsnap -g Oryza_indica.ASM465v1.25.dna.chromosome*fa.gz &gt; gmapbuild.log
</code></pre>

<h1>The kallisto approach</h1>

<p>I used a recently released K-mer approach <a href="http://pachterlab.github.io/kallisto/">kallisto</a>. It is on github and are well documented. The whole procedure takes only two steps for both single-end and paired-end sequencing as below.</p>

<pre><code>### indexing
kallisto index -k 31 -i Osativa_204_v7_1transcript Osativa_204_v7.0.transcript_primaryTranscriptOnly
### quantification
kallisto quant -i index -o output pairA_1.fastq pairA_2.fastq pairB_1.fastq pairB_2.fastq
</code></pre>

<h1>Comparing of the results</h1>

<p>The Pearson's correlation coefficient (r) ranged from 0.8 to 0.94. That is an impressive correlation, indicating the <code>kallisto</code> is indeed as accurate as alignment-based approach. I looked into the outliers on the left sides of the plots and found those dots were from genes with repeat sequences. Note that with the alignment-based approach, I kept only uniquely mapped reads for quantification purpose. After removing these several outlier genes, the correlations become more significant.</p>

<p>Overall, I think <code>kallisto</code> is a simple and rapid RNA-seq quantification alternative for alignment-based approach. However, <code>kallisto</code> may over-estimate the read counts from genes containing repeats. For differential expression analysis, this may not be a critical problem since the over-estimation will not be biased.</p>

<p><img src="http://i.imgur.com/UVU28KJ.png" alt="Imgur" /></p>

<div class="share-page">
<h2 style="background:#faebd7;">
    Share this on &rarr; 
    <a href="https://twitter.com/intent/tweet?text=RNA-seq quantification comparison: K-mer vs. alignment approaches&url=http://yangjl.com/tech%20report/2015/06/03/rna-seq&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter">Twitter</a>
    <a href="https://facebook.com/sharer.php?u=http://yangjl.com/tech%20report/2015/06/03/rna-seq" rel="nofollow" target="_blank" title="Share on Facebook">Facebook</a>
    <a href="https://plus.google.com/share?url=http://yangjl.com/tech%20report/2015/06/03/rna-seq" rel="nofollow" target="_blank" title="Share on Google+">Google+</a>
</h2> 
<style type="text/css">
    .share-page {
        text-align: center;
        background: $secondary-color;
        color: $light-color;
        padding: 8px 15px;
        border-radius: 5px;
        margin: 1.5 * $spacing-unit 0;

        h2 {
            font-weight: 700;
            color: #458b74;
            margin-left: 10px;

            &:hover {
                border-bottom: 1px dashed #458b74;
            }
        }
    }
</style>    
</div>




    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#tech report-ref">
    		tech report <span>1</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#NGS-ref">NGS <span>7</span></a></li>
     
    	<li><a href="/tags.html#codes-ref">codes <span>3</span></a></li>
     
    	<li><a href="/tags.html#notes-ref">notes <span>9</span></a></li>
     
    	<li><a href="/tags.html#RNA-seq-ref">RNA-seq <span>1</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/codes/2015/05/27/zip" title="Compression related commands">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/notes/2015/06/17/command-line" title="The art of command line">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'yangjl'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>


      </div>
      <hr>
      <footer align="center">
         <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> on GitHub | Copyright 2016 by <a href="http://yangjl.com">Jinliang Yang</a> | <span class="label label-info">2016-09-09 12:26:17</span></small></p>
      </footer>

    </div>

    
  </body>
</html>

